# LDID Method Specification

## Abstract

LDID distributed identity is a basic public identity authentication service based on blockchain,provide distributed entity identity and management functions,committed to becoming a basic service for smart society,value exchange through trusted authenticated identities.The system is designed to provide secure authentication and various services based on the DID and Verifiable Credentials specifications published by the W3C.As an identity verification technology, LDID aims to use blockchain technology to prove one's identity without the need for a separate centralized organization and cannot be forged and tampered with.

## Status Of This Document

This draft document follows the [W3C DIDs](https://www.w3.orgTR2022REC-did-core-20220719) standard and will continue to be refined and improved over the next one to two years.

## LDID Distributed Identity Method Specification


### MethodName

The LDID identifier of did distributed identity is defined as: `ldid`.The ldid method must contain the prefix: `did:ldid`, and the prefix must consist of lowercase letters.

The ldid method format consists of the following format:

```shell
# ldid did
did:ldid:<method-specific-id>

# method-specific-id
method-specific-id = base58(sha256(<Public Key Pem Format>))
```

To improve interoperability, the identifier is calculated from a public key encoded in pem format and then (optionally) published in a decentralized blockchain.

LDID EXAMPLE： `did:ldid:Qmc4wexitHpCTKjXXFxvtgeW2KprTuYv5RDDs8FpspwL48`

## DID Document

`did:ldid:Qmc4wexitHpCTKjXXFxvtgeW2KprTuYv5RDDs8FpspwL48` corresponding did document example：

```json
{
  "@context": "https://w3id.org/did/v1",
  "id": "did:ldid:Qmc4wexitHpCTKjXXFxvtgeW2KprTuYv5RDDs8FpspwL48",
  "created": "2023-10-23T18:19:39Z",
  "updated": null,
  "verificationMethod": [
    {
      "id": "did:ldid:Qmc4wexitHpCTKjXXFxvtgeW2KprTuYv5RDDs8FpspwL48",
      "type": "sm2",
      "controller": "did:ldid:Qmc4wexitHpCTKjXXFxvtgeW2KprTuYv5RDDs8FpspwL48",
      "publicKeyPem": "-----BEGIN PUBLIC KEY-----\r\nMFkwEwYHKoZIzj0CAQYIKoEcz1UBgi0DQgAEzwXoM5J/My1xwVTe+jS5gP+fit1Z\r\nUiv5fBdl6FvcLc6IL/IYDihP6cUeJqS9d55dFlGuObQBJl4IpJyMk/GQlw==\r\n-----END PUBLIC KEY-----"
    }
  ],
  "authentication": [
       "did:ldid:Qmc4wexitHpCTKjXXFxvtgeW2KprTuYv5RDDs8FpspwL48"
  ],
  "service": []
}
```

## LDID Operation

In order to ensure the privacy of user sensitive information generated by ldid，by generating did and did documents on the local client, did and did documents can be selectively saved to the blockchain system. This function is implemented by sending transactions to the blockchain through smart contracts.

During the entire process, user-related sensitive information is processed locally (including private keys, user-related information, etc.), and only hash values and other information are uploaded to the blockchain system. The system's CRUD operations on DID are interacted and completed through the http protocol.

### Create

The main steps are as follows:

1) Generate the identity identifier ldid, use the client tool provided by the system, and generate did and did documents that comply with the standard specifications based on the public key content entered by the user;
2) Use the private key to sign the generated did, and package the user's public key and signature information into a data structure that conforms to the on-chain transaction;
3) Send the transaction and store the did and did documents into the blockchain system by sending the transaction to the blockchain.


#### Create did and did doc

request parameter description:

| parameter    | type   | description              |
|--------------|--------|--------------------------|
| publicKeyPem | String | public key in pem format |


return parameter description:

| parameter | type   | description                                             |
|-----------|--------|---------------------------------------------------------|
| code      | Int    | error code, 0 represents success, others fail.          |
| message   | String | error code description information                      |
| data      | Object | return structural information, here is the did document |


request example:

```json
{
  "publicKeyPem": "-----BEGIN PUBLIC KEY-----\r\nMFkwEwYHKoZIzj0CAQYIKoEcz1UBgi0DQgAEzwXoM5J/My1xwVTe+jS5gP+fit1Z\r\nUiv5fBdl6FvcLc6IL/IYDihP6cUeJqS9d55dFlGuObQBJl4IpJyMk/GQlw==\r\n-----END PUBLIC KEY-----"
}
```

response example：

```json
{
  "code": 0,
  "message": "success",
  "data": {
    "did": "did:ldid:Qmc4wexitHpCTKjXXFxvtgeW2KprTuYv5RDDs8FpspwL48",
    "didDoc": {
      "@context": "https://w3id.org/did/v1",
      "id": "did:ldid:Qmc4wexitHpCTKjXXFxvtgeW2KprTuYv5RDDs8FpspwL48",
      "created": "2023-10-23T18:19:39Z",
      "updated": null,
      "verificationMethod": [
        {
          "id": "did:ldid:Qmc4wexitHpCTKjXXFxvtgeW2KprTuYv5RDDs8FpspwL48",
          "type": "sm2",
          "controller": "did:ldid:Qmc4wexitHpCTKjXXFxvtgeW2KprTuYv5RDDs8FpspwL48",
          "publicKeyPem": "-----BEGIN PUBLIC KEY-----\r\nMFkwEwYHKoZIzj0CAQYIKoEcz1UBgi0DQgAEzwXoM5J/My1xwVTe+jS5gP+fit1Z\r\nUiv5fBdl6FvcLc6IL/IYDihP6cUeJqS9d55dFlGuObQBJl4IpJyMk/GQlw==\r\n-----END PUBLIC KEY-----"
        }
      ],
      "authentication": [
        "did:ldid:Qmc4wexitHpCTKjXXFxvtgeW2KprTuYv5RDDs8FpspwL48"
      ],
      "service": []
    }
  }
}
```

#### send did and did doc to blockchain

request parameter description:

| parameter | type   | description                        |
|-----------|--------|------------------------------------|
| did       | String | did unique identifier              |
| didDoc    | String | did document                       |
| signature | String | Signature of did using private key |

return parameter description:

| parameter | type   | description                                    |
|-----------|--------|------------------------------------------------|
| code      | Int    | error code, 0 represents success, others fail. |
| message   | String | error code description information             |
| data      | Object | transaction id on the blockchain               |

request example:

```json
{
  "did": "did:ldid:Qmc4wexitHpCTKjXXFxvtgeW2KprTuYv5RDDs8FpspwL48",
  "didDoc": {
    "@context": "https://w3id.org/did/v1",
    "id": "did:ldid:Qmc4wexitHpCTKjXXFxvtgeW2KprTuYv5RDDs8FpspwL48",
    "created": "2023-10-23T18:19:39Z",
    "updated": null,
    "verificationMethod": [
      {
        "id": "did:ldid:Qmc4wexitHpCTKjXXFxvtgeW2KprTuYv5RDDs8FpspwL48",
        "type": "sm2",
        "controller": "did:ldid:Qmc4wexitHpCTKjXXFxvtgeW2KprTuYv5RDDs8FpspwL48",
        "publicKeyPem": "-----BEGIN PUBLIC KEY-----\r\nMFkwEwYHKoZIzj0CAQYIKoEcz1UBgi0DQgAEzwXoM5J/My1xwVTe+jS5gP+fit1Z\r\nUiv5fBdl6FvcLc6IL/IYDihP6cUeJqS9d55dFlGuObQBJl4IpJyMk/GQlw==\r\n-----END PUBLIC KEY-----"
      }
    ],
    "authentication": [
      "did:ldid:Qmc4wexitHpCTKjXXFxvtgeW2KprTuYv5RDDs8FpspwL48"
    ],
    "service": []
  },
  "signature": "<valid signature info>"
}
```

response example:

```json
{
  "code": 0,
  "message": "success",
  "data": {
    "txId":"<valid transaction id>"
  }
}
```

### Update

Currently, DID documents do not support update operations.

### Deactivate

Users can deactivate the did document on the chain by entering did and the signed content of did，the signature information is used to verify that the executor of the operation is the owner of the current did.

request parameter description:

| parameter | type   | description                        |
|-----------|--------|------------------------------------|
| did       | String | did unique identifier              |
| signature | String | Signature of did using private key |

return parameter description:

| parameter | type   | description                                    |
|-----------|--------|------------------------------------------------|
| code      | Int    | error code, 0 represents success, others fail. |
| message   | String | error code description information             |
| data      | Object | transaction id on the blockchain               |


request example:

```json
{
  "did":  "did:ldid:Qmc4wexitHpCTKjXXFxvtgeW2KprTuYv5RDDs8FpspwL48",
  "signature": "<valid signature info>"
}
```

response example:

```json
{
  "code": 0,
  "message": "success",
  "data": {
    "txId":"<valid transaction id>"
  }
}
```
## Security Considerations

1. did and did documents are stored based on the blockchain, so DDOS network attacks can be effectively avoided;
2. In this system, all data related to user privacy is stored locally, and the hash value or string generated by the encryption algorithm is public on the chain. An attacker cannot deduce private data through the hash value or string;
3. In order to prevent the DID document from being maliciously tampered with, any modification to the DID document must be digitally signed.

## Privacy Considerations

1. There is no user personal privacy information in the did document, only the user's public key related information is saved on the blockchain, and the did subject cannot be identified through the did document;
2. The user’s verifiable credentials are encrypted and stored in cloud storage through a symmetric encryption key such as SK or other negotiated passwords, and only the entity with the key can decrypt and view it;
3. Achieve privacy data protection of certificate holders through selective disclosure;
4. For did and did documents to be published on a specific blockchain network, user authorization is required.

